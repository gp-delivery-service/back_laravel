<?php

namespace Database\Seeders;

use App\Models\GpMapStreet;
use Illuminate\Database\Console\Seeds\WithoutModelEvents;
use Illuminate\Database\Seeder;

class GpStreetsSeeder extends Seeder
{
    /**
     * Run the database seeds.
     */
    public function run(): void
    {
        $streets = [
            [
                "id" => 1,
                "name" => "Чехова",
                "coordinates" => [
                    [
                        58.37400139989481,
                        37.95455672816861
                    ],
                    [
                        58.37314390617766,
                        37.953598867159
                    ],
                    [
                        58.37250078588886,
                        37.95352374027705
                    ],
                    [
                        58.371857665600004,
                        37.95348617680688
                    ],
                    [
                        58.371166906769844,
                        37.95335470451124
                    ],
                    [
                        58.37071434064063,
                        37.95305419552375
                    ],
                    [
                        58.36964247349317,
                        37.95185214728042
                    ],
                    [
                        58.368141862005075,
                        37.950124182203155
                    ],
                    [
                        58.367284368285965,
                        37.94909113198139
                    ],
                    [
                        58.366736525077926,
                        37.94818954900852
                    ],
                    [
                        58.36645069383752,
                        37.94734430492295
                    ],
                    [
                        58.36618868186983,
                        37.946311215613775
                    ],
                    [
                        58.36573611574062,
                        37.944338913870084
                    ],
                    [
                        58.36523591106996,
                        37.94238534376798
                    ],
                    [
                        58.36487861369551,
                        37.94048808889521
                    ],
                    [
                        58.36461660172583,
                        37.939229478927075
                    ],
                    [
                        58.364640420996466,
                        37.93823384681741
                    ],
                    [
                        58.364950071505575,
                        37.93740727406541
                    ],
                    [
                        58.36573608795413,
                        37.935866837399516
                    ],
                    [
                        58.36704614780055,
                        37.933480945727624
                    ],
                    [
                        58.36864203888726,
                        37.93066286369255
                    ],
                    [
                        58.369308978446725,
                        37.92947923702435
                    ],
                    [
                        58.36978536384669,
                        37.92878408232086
                    ],
                    [
                        58.370476122674916,
                        37.92812649749827
                    ],
                    [
                        58.372191104498626,
                        37.92705556374524
                    ],
                    [
                        58.37643093454875,
                        37.92510153425398
                    ]
                ],

            ],
            [
                "id" => 2,
                "name" => "Алишера Навои",
                "coordinates" => [
                    [
                        58.38115171216208,
                        37.95086924421844
                    ],
                    [
                        58.3791741844808,
                        37.94849033338906
                    ],
                    [
                        58.378235941420115,
                        37.9473065404472
                    ],
                    [
                        58.37693683736282,
                        37.945735705120384
                    ],
                    [
                        58.37643162956104,
                        37.94332247808086
                    ],
                    [
                        58.37608520135416,
                        37.94119376391721
                    ],
                    [
                        58.37566043749763,
                        37.93897002443305
                    ],
                    [
                        58.37545835437663,
                        37.93774054133715
                    ],
                    [
                        58.37545835420289,
                        37.93719409793145
                    ],
                    [
                        58.37550165772774,
                        37.936715956507285
                    ],
                    [
                        58.37566043732272,
                        37.936158120914484
                    ],
                    [
                        58.376021300038644,
                        37.935588896558414
                    ],
                    [
                        58.376454335297524,
                        37.93513351389909
                    ],
                    [
                        58.37704615015133,
                        37.93470089776025
                    ],
                    [
                        58.37782561361715,
                        37.934268279074914
                    ],
                    [
                        58.37867724962578,
                        37.93383565784339
                    ],
                    [
                        58.37988974834923,
                        37.933243645716885
                    ]
                ]
            ],
            [
                "id" => 3,
                "name" => "Б. Кербабаева",
                "coordinates" => [
                    [
                        58.382024077153886,
                        37.95024627229422
                    ],
                    [
                        58.37804808628218,
                        37.94538542496569
                    ],
                    // [
                    //     58.37757518601859,
                    //     37.94309257826613
                    // ]
                ],
            ]
        ];

        foreach ($streets as $street) {
            $new_street = GpMapStreet::updateOrCreate(
                [
                    'id' => $street['id'],
                ],
                [
                    'name' => $street['name'],
                ]
            );
            foreach ($street['coordinates'] as $key => $coordinate) {
                $new_street->points()->updateOrCreate(
                    [
                        'street_id' => $new_street->id,
                        'order' => $key,
                    ],
                    [
                        'lat' => $coordinate[1],
                        'lng' => $coordinate[0],
                    ]
                );
            }
            $new_street->save();
            $new_street->points()->saveMany($new_street->points);
        }
    }
}
